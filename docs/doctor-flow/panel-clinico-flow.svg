<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="900" viewBox="0 0 1200 900">
  <defs>
    <style>
      .title { font-family: 'Segoe UI', Arial, sans-serif; font-size: 30px; font-weight: 600; fill: #1F2933; }
      .subtitle { font-family: 'Segoe UI', Arial, sans-serif; font-size: 16px; fill: #52606D; }
      .label { font-family: 'Segoe UI', Arial, sans-serif; font-size: 16px; fill: #102A43; }
      .small { font-family: 'Segoe UI', Arial, sans-serif; font-size: 14px; fill: #52606D; }
      .process { fill: #F2F7FA; stroke: #2F4858; stroke-width: 2; }
      .decision { fill: #FFE8C8; stroke: #C4742C; stroke-width: 2; }
      .start-end { fill: #EAF7F0; stroke: #2F855A; stroke-width: 2; }
      .annotation { fill: #FFFFFF; stroke: #9AA5B1; stroke-width: 1.5; }
      .arrow { stroke: #2F4858; stroke-width: 2.5; fill: none; marker-end: url(#arrowhead); }
      .arrow-soft { stroke: #829AB1; stroke-width: 2; fill: none; marker-end: url(#arrowhead); stroke-dasharray: 6 6; }
    </style>
    <marker id="arrowhead" markerWidth="12" markerHeight="12" refX="10" refY="6" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L12,6 L0,12 Z" fill="#2F4858"/>
    </marker>
  </defs>

  <rect x="0" y="0" width="1200" height="900" fill="#F8FAFC"/>
  <rect x="70" y="110" width="1060" height="760" fill="#FFFFFF" stroke="#D9E2EC" stroke-width="2" rx="24" ry="24"/>

  <text x="600" y="70" text-anchor="middle" class="title">Vista panel clinico - flujo de datos y render</text>
  <text x="600" y="100" text-anchor="middle" class="subtitle">Describe como se arma la portada con oferta vigente y acciones principales</text>

  <!-- Start -->
  <circle cx="600" cy="160" r="36" class="start-end"/>
  <text x="600" y="160" text-anchor="middle" dominant-baseline="middle" class="label" font-weight="600">Ingreso</text>
  <text x="600" y="194" text-anchor="middle" class="small">Doctor abre /doctor</text>

  <!-- Cookie check -->
  <rect x="470" y="220" width="260" height="80" rx="20" ry="20" class="process"/>
  <text x="600" y="260" text-anchor="middle" class="label">
    <tspan x="600" dy="-10" font-weight="600">Detectar RUT en cookie</tspan>
    <tspan x="600" dy="24">Hook inicial lee `rut`</tspan>
  </text>

  <!-- Decision RUT -->
  <polygon points="600,320 684,380 600,440 516,380" class="decision"/>
  <text x="600" y="380" text-anchor="middle" class="label" font-weight="600">RUT encontrado?</text>
  <text x="680" y="360" class="small" font-weight="600">Si</text>
  <text x="540" y="430" class="small" font-weight="600">No</text>

  <!-- No path -->
  <rect x="230" y="440" width="280" height="90" rx="22" ry="22" class="process"/>
  <text x="370" y="485" text-anchor="middle" class="label">
    <tspan x="370" dy="-10" font-weight="600">Mostrar aviso de sesion</tspan>
    <tspan x="370" dy="24">Boton: iniciar nuevamente</tspan>
  </text>
  <circle cx="370" cy="560" r="26" class="start-end"/>
  <text x="370" y="560" text-anchor="middle" dominant-baseline="middle" class="label" font-weight="600">Fin</text>
  <path d="M516 380 L370 380 L370 440" class="arrow"/>

  <!-- Fetch profile -->
  <rect x="720" y="320" width="280" height="90" rx="22" ry="22" class="process"/>
  <text x="860" y="366" text-anchor="middle" class="label">
    <tspan x="860" dy="-10" font-weight="600">Solicitar perfil doctor</tspan>
    <tspan x="860" dy="24">`/api/doctors?rut=...`</tspan>
  </text>

  <!-- Decision doctor -->
  <polygon points="860,430 940,490 860,550 780,490" class="decision"/>
  <text x="860" y="490" text-anchor="middle" class="label" font-weight="600">Perfil valido?</text>
  <text x="940" y="470" class="small" font-weight="600">Si</text>
  <text x="816" y="540" class="small" font-weight="600">No</text>

  <!-- No doctor -->
  <rect x="660" y="560" width="240" height="90" rx="22" ry="22" class="process"/>
  <text x="780" y="604" text-anchor="middle" class="label">
    <tspan x="780" dy="-10" font-weight="600">Mostrar error sin perfil</tspan>
    <tspan x="780" dy="24">Sugerir contacto a soporte</tspan>
  </text>
  <circle cx="780" cy="680" r="26" class="start-end"/>
  <text x="780" y="680" text-anchor="middle" dominant-baseline="middle" class="label" font-weight="600">Fin</text>
  <path d="M780 490 L780 560" class="arrow"/>

  <!-- Fetch catalogs -->
  <rect x="920" y="560" width="220" height="120" rx="22" ry="22" class="process"/>
  <text x="1030" y="610" text-anchor="middle" class="label">
    <tspan x="1030" dy="-10" font-weight="600">Descargar catalogos</tspan>
    <tspan x="1030" dy="24">Especialidades, pisos, sedes</tspan>
    <tspan x="1030" dy="24">Boxes asignados y bloqueos</tspan>
  </text>

  <!-- Preparar datos -->
  <rect x="520" y="640" width="280" height="100" rx="22" ry="22" class="process"/>
  <text x="660" y="690" text-anchor="middle" class="label">
    <tspan x="660" dy="-10" font-weight="600">Preparar oferta vigente</tspan>
    <tspan x="660" dy="24">Cruza asignaciones con catalogos</tspan>
    <tspan x="660" dy="24">Genera resumen de boxes por piso</tspan>
  </text>

  <!-- Render -->
  <rect x="380" y="760" width="440" height="100" rx="24" ry="24" class="process"/>
  <text x="600" y="800" text-anchor="middle" class="label">
    <tspan x="600" dy="-10" font-weight="600">Renderizar vista panel clinico</tspan>
    <tspan x="600" dy="24">Encabezado con datos personales</tspan>
    <tspan x="600" dy="24">Grid de oferta por piso y accion exportar</tspan>
  </text>

  <!-- End -->
  <circle cx="600" cy="884" r="30" class="start-end"/>
  <text x="600" y="884" text-anchor="middle" dominant-baseline="middle" class="label" font-weight="600">Continua</text>
  <text x="600" y="916" text-anchor="middle" class="small">Acceso a reserva y bloqueos</text>

  <!-- Connectors -->
  <line x1="600" y1="196" x2="600" y2="220" class="arrow"/>
  <line x1="600" y1="300" x2="600" y2="320" class="arrow"/>
  <path d="M684 380 H720" class="arrow"/>
  <line x1="860" y1="410" x2="860" y2="430" class="arrow"/>
  <path d="M940 490 H1010 V560" class="arrow"/>
  <path d="M1030 680 H880 V640" class="arrow"/>
  <line x1="660" y1="740" x2="600" y2="760" class="arrow"/>
  <line x1="600" y1="860" x2="600" y2="854" class="arrow"/>

  <!-- Annotation -->
  <rect x="120" y="620" width="220" height="150" rx="18" ry="18" class="annotation"/>
  <text x="230" y="660" text-anchor="middle" class="label">
    <tspan x="230" dy="-8" font-weight="600">Estados de carga</tspan>
    <tspan x="230" dy="22">- Skeleton y textos de progreso</tspan>
    <tspan x="230" dy="22">- Manejo de errores por fetch</tspan>
    <tspan x="230" dy="22">- Reintentos con React Query</tspan>
  </text>
  <path d="M470 360 H340 V620" class="arrow-soft"/>
</svg>
